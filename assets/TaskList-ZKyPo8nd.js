import{t as E,_ as I,a as S}from"./Search-msQSUujA.js";import{a as $}from"./tasks-tvHa4Sbp.js";import{T as B}from"./TaskListItem-5qKXs_GJ.js";import{_ as M,r as d,o as x,N,b as j,c as p,d as _,e as a,f as r,h as L,s as A,J as C,K as G}from"./index-2VcAIsLU.js";const b=l=>(C("data-v-6b76e6b2"),l=l(),G(),l),H={class:"container mt-3"},V={class:"row"},z={class:"col-md-4"},F={class:"col-md-8"},J=b(()=>a("div",{class:"d-flex flex-wrap justify-content-between mb-2"},[a("h4",null,"全任務列表")],-1)),K={class:"position-relative mt-5",style:{"min-height":"300px"}},P={key:0,class:"list-unstyled"},U={key:1,class:"d-flex justify-content-center mt-8"},q=b(()=>a("p",{class:"badge bg-light fs-6 fw-normal rounded-pill py-1 px-3 text-dark lh-base"},"尚無任務",-1)),D=[q],O={__name:"TaskList",setup(l){const{apiGetAvailableTask:w}=$,e=E(),c=d(!1),o=d([]),n=d({current:1,count:10,next:11}),v=d(null),u=async(s=1,m=10)=>{var i,f,h,k;c.value=!0;try{const{tasks:t,pagination:T}=await w(s,m,v.value);s>1?o.value=[...o.value,...t]:o.value=t,n.value=T}catch(t){A.toastMessage("danger","info",`${(f=(i=t==null?void 0:t.response)==null?void 0:i.data)==null?void 0:f.statusCode}:${(k=(h=t==null?void 0:t.response)==null?void 0:h.data)==null?void 0:k.message}`)}c.value=!1},y=s=>{v.value=s,u(1,10)};x(()=>{u(),e.groups&&e.groups.length===0&&e.tags&&e.tags.length===0&&e.getGroupsAndTags()});const g=()=>{const s=document.documentElement;if(s.clientHeight+s.scrollTop===s.scrollHeight){if(c.value||!n.value.next||n.value.current===n.value.next)return;u(n.value.next)}};return x(()=>{window.addEventListener("scroll",g)}),N(()=>{window.removeEventListener("scroll",g)}),(s,m)=>{const i=j("Loading");return p(),_("div",H,[a("div",V,[a("div",z,[r(S)]),a("div",F,[J,r(I,{tags:L(e).tags,groups:L(e).groups,onSearch:y},null,8,["tags","groups"]),a("div",K,[r(i,{"is-full-page":!1,active:c.value,"z-index":1060},null,8,["active"]),o.value.length>0?(p(),_("ul",P,[r(B,{type:"task","task-list":o.value},null,8,["task-list"])])):(p(),_("div",U,D))])])])])}}},Y=M(O,[["__scopeId","data-v-6b76e6b2"]]);export{Y as default};
