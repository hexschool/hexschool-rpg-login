import{u as N,a as $,r as _,o as P,b as d,c as C,d as M,w as j,v as z,e,f as n,g as R,h as b,i as B,F as U,j as D,n as L,k as v,t as G,l as i,m as A,p as X,q as V,s as Z}from"./index-2VcAIsLU.js";import{_ as H,a as J}from"./PolicyModal-wEJ1eVaN.js";import"./Modal-8DUmgg4S.js";const K=e("div",{class:"mb-4 d-flex align-items-baseline"},[e("h1",{class:"h2 me-auto"}," 登入 ")],-1),O={class:"mb-3"},Q=e("label",{for:"account",class:"form-label"},"帳號（Email）",-1),W={class:"mb-3"},Y={class:"d-flex justify-content-between align-items-center"},ee=e("label",{for:"password",class:"form-label"},"密碼",-1),te={href:"#",class:"text-decoration-none"},se={class:"d-grid gap-2 mb-4"},ae=["disabled"],oe={class:"text-end text-dark"},ne=e("div",{class:"position-relative"},[e("hr"),i(),e("span",{class:"position-absolute top-50 start-50 bg-white text-dark translate-middle px-3"},"或")],-1),ie=e("img",{class:"img-fluid me-1",width:"30",src:J,alt:"teachable-logo"},null,-1),le={class:"text-dark fw-normal"},re={key:0},ce={class:"position-relative d-flex flex-column algin-items-center",style:{height:"100vh"}},de=e("p",{class:"text-center position-absolute",style:{left:"50%",top:"200px",transform:"translateX(-50%)"}},"確認使用者身份中 ...",-1),he={__name:"Login",setup(ue){const{apiPostLogin:q,apiGetLoginTeachable:g}=A,{apiGetNotifyMessageConstants:F}=X,f=N(),y=$(),I=V(async t=>{await q(t),localStorage.setItem("d_RTfznkkwslIopaqd_account",encodeURIComponent(t.account)),Z.toastMessage("success","","登入成功"),f.push("/login/verify")}),u=_(!0);P(async()=>{const{h_redirect:t,h_path:s,redirectType:a,route:o,bind:r}=y.query;if(u.value=!0,D("h_MqhC49RxFRI6pR3Z_token")&&(await F()).message==="成功"){if(r==="true"){const l={};l.redirectType=a,l.route=o;const h=new URLSearchParams(l).toString(),c=await g(h);window.location.href=c.redirect_url;return}f.push("/dashboard")}u.value=!1,a&&o&&(localStorage.setItem("t_redirectType",a),localStorage.setItem("t_redirectRoute",o),f.replace({query:{}})),t&&localStorage.setItem("h_redirect",`${t}#${s||"/"}`)});const w=V(async()=>{const{redirectType:t,route:s}=y.query,a={redirectType:"user"};t==="teachable"&&(a.redirectType=t,a.route=s);const o=new URLSearchParams(a).toString(),r=await g(o);window.location.href=r.redirect_url}),k=_(""),p=_(null),x=t=>{k.value=t,t==="user"?p.value.modalTitle="使用者條款":p.value.modalTitle="隱私權政策",p.value.showModal()},m=_(!1),E=()=>{m.value=!m.value};return(t,s)=>{const a=d("VField"),o=d("ErrorMessage"),r=d("router-link"),S=d("VForm"),T=d("Loading");return C(),M(U,null,[j(e("div",null,[n(S,{ref:"form",onSubmit:b(I)},{default:R(({errors:l,meta:h})=>[K,e("div",O,[Q,n(a,{id:"account",name:"account",label:"帳號（Email）",type:"email",class:L(["form-control",{"is-invalid":l.account}]),rules:"required|email"},null,8,["class"]),n(o,{name:"account",class:"invalid-feedback"})]),e("div",W,[e("div",Y,[ee,e("a",te,[e("span",{title:"顯示密碼",class:"bg-transparent material-symbols-outlined d-block fs-5",onClick:v(E,["prevent"])},G(m.value?"visibility_off":"visibility"),1)])]),n(a,{id:"password",name:"password",label:"密碼",type:m.value?"text":"password",class:L(["form-control",{"is-invalid":l.password}]),rules:"required",autocomplete:"current-password"},null,8,["type","class"]),n(o,{name:"password",class:"invalid-feedback"})]),e("div",se,[e("button",{type:"submit",class:"btn btn-primary",disabled:!h.valid}," 登入 ",8,ae),e("p",oe,[i(" 忘記密碼了嗎？"),n(r,{to:"/password/reset",class:"text-primary fw-bold"},{default:R(()=>[i("重設密碼")]),_:1})]),ne,e("button",{type:"button",class:"btn btn-outline-primary d-flex align-items-center justify-content-center",onClick:s[0]||(s[0]=(...c)=>b(w)&&b(w)(...c))},[ie,i(" 以 Teachable 登入或註冊 ")])]),e("h6",le,[i(" 若登入即表示你已經閱讀並接受我們的"),e("a",{href:"#",class:"text-dark",onClick:s[1]||(s[1]=v(c=>x("user"),["prevent"]))},"使用者條款"),i("和"),e("a",{href:"#",class:"text-dark",onClick:s[2]||(s[2]=v(c=>x("private"),["prevent"]))},"隱私權政策"),i("。 ")])]),_:1},8,["onSubmit"])],512),[[z,!u.value]]),u.value?(C(),M("div",re,[e("div",ce,[de,n(T,{"is-full-page":!1,active:!0,"z-index":1060,style:{height:"300px"}})])])):B("",!0),n(H,{ref_key:"policyModalRef",ref:p,status:k.value},null,8,["status"])],64)}}};export{he as default};
